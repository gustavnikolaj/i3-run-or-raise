#!/usr/bin/env node

var filter = require('../lib/filter');
var getWindows = require('../lib/getWindows');
var findWindowIdsByClass = require('../lib/findWindowIdsByClass');

var argv = require('optimist').alias('c', 'class')
                              .alias('n', 'name')
                              .argv;

getWindows(function (windows) {
    if (argv.n) {
        windows = filter.byName(windows, argv.n);
    }
    if (argv.c) {
        findWindowIdsByClass(argv.c, function (windowIds) {
            windows = filter.byWindowId(windows, windowIds);
            runOrRaise(windows);
        })
    } else {
        runOrRaise(windows);
    }
});

function runOrRaise(windows) {
    console.log(windows);
    if (argv._) {
        console.log('If no match is found, exec: ', argv._);
    }
}
